function Trim(strValue){return LTrim(RTrim(strValue))}function LTrim(strValue){var LTRIMrgExp=/^\s*/;return strValue.replace(LTRIMrgExp,"")}function RTrim(strValue){var RTRIMrgExp=/\s*$/;return strValue.replace(RTRIMrgExp,"")}function validateFnr(fodselsNummer){var numArray=[0,0,0,0,0,0,0,0,0,0,0],checksum=0,rest=0,WEIGHTS1=[3,7,6,1,8,9,4,5,2],WEIGHTS2=[5,4,3,2,7,6,5,4,3,2],BIRTH_NUMBER_LENGTH=11,CHECKSUM_CONSTANT=11,CHECKSUM_MODULO=11;if("undefined"==fodselsNummer||fodselsNummer.length!=BIRTH_NUMBER_LENGTH||"00000000000"==fodselsNummer)return!1;for(i=0;BIRTH_NUMBER_LENGTH>i;i++){var c=fodselsNummer.charAt(i);if("0">c||c>"9")return!1;numArray[i]=c}for(i=0;BIRTH_NUMBER_LENGTH-2>i;i++)checksum+=numArray[i]*WEIGHTS1[i];if(rest=checksum%CHECKSUM_MODULO,0==rest&&(rest=CHECKSUM_CONSTANT),checksum=parseInt(numArray[BIRTH_NUMBER_LENGTH-2])+rest-CHECKSUM_CONSTANT,0!=checksum)return!1;for(checksum=0,i=0;BIRTH_NUMBER_LENGTH-1>i;i++)checksum+=numArray[i]*WEIGHTS2[i];return rest=checksum%CHECKSUM_MODULO,(0==rest||1==rest)&&(rest=CHECKSUM_CONSTANT),checksum=parseInt(numArray[BIRTH_NUMBER_LENGTH-1])+rest-CHECKSUM_CONSTANT,0==checksum&&(validfnr=!0),0==checksum}function validateInput(){clearErrorMessages();var errorOccured=!1;return errorOccured=validerBeskrivelsesFelt(),isTilbakemelding()?errorOccured|=validerEpostFelt():isKlagePaaService()?errorOccured=errorOccured|validerPersonnummerFelt()|validerOrgnr()|validerValgtEnhet()|validerRequired():isRos()&&(errorOccured|=validerValgtEnhet()),errorOccured?!1:void 0}function validerRequired(){$("form input.required").each(function(){var input=$(this),trimmedText=$.trim($(input).val());return trimmedText.length>0?(input.siblings(".formgroup-error").hide(),!1):(input.siblings(".formgroup-error").show(),!0)})}function clearErrorMessages(){$(".orgnrError").hide(),$(".formgroup-error").hide(),$(".enhetError").hide(),$(".pnrError").hide(),$(".epostError").hide(),$(".beskrivelseError").hide()}function validerBeskrivelsesFelt(){var beskrivelseErrorMsg="";return isTextAreaEmpty($.trim($("#beskrivelse").val()))&&(beskrivelseErrorMsg="<p>Tilbakemeldingsfeltet er ikke fylt ut</p>"),""!=beskrivelseErrorMsg?(beskrivelseErrorMsg='<a name="scrollTop">&nbsp;</a><div class="NAVerrorBox">'+beskrivelseErrorMsg+"</div>",$(".beskrivelseError").html(beskrivelseErrorMsg),$(".beskrivelseError").show(),!0):!1}function validerEpostFelt(){if($("#tbEmail").length){var epostErrorMsg="";return epost=$("#tbEmail").val(),""!=epost&&(AtPos=epost.indexOf("@"),StopPos=epost.lastIndexOf("."),(-1==AtPos||-1==StopPos)&&(epostErrorMsg="<p>E-postadressen er ikke gyldig </p>")),""!=epostErrorMsg?(epostErrorMsg='<a name="scrollTop">&nbsp;</a><div class="NAVerrorBox">'+epostErrorMsg+"</div>",$(".epostError").html(epostErrorMsg),$(".epostError").show(),!0):!1}}function validerPersonnummerFelt(){if($("#klagerPersonnummer").length){var pNrErrorMsg="",fnr=$("#klagerPersonnummer").val();return 11!=fnr.length||isNaN(fnr)?pNrErrorMsg="<p>Fødselsnummer skal bestå av 11 siffer</p>":validateFnr(fnr)||(pNrErrorMsg="<p>Fødselsnummer er ikke gyldig</p>"),""!=pNrErrorMsg?(pNrErrorMsg='<div class="NAVerrorBox">'+pNrErrorMsg+"</div>",$(".pnrError").html(pNrErrorMsg),$(".pnrError").show(),!0):($(".pnrError").html(""),$(".pnrError").hide(),!1)}}function validerOrgnr(){if($("#orgnr").length){var orgNrFormat=/^[0-9]{9}$/,orgNr=$("#orgnr").val(),orgNrErrorMsg='<div class="NAVerrorBox"><p>Organisasjonsnummer skal bestå av ni siffer</p></div>';if(!orgNr.match(orgNrFormat))return $(".orgnrError").html(orgNrErrorMsg).show(),!0;if(!orgNr.match(orgNrFormat))return!1;orgMod11(orgNr)}}function orgMod11(orgNr){for(var factor=[3,2,7,6,5,4,3,2],productSum=0,remainer=0,controlDigit=0,i=0;8>i;i++)productSum+=orgNr[i]*factor[i];return remainer=productSum%11,controlDigit=0===remainer?0:11-remainer,1!==remainer&&controlDigit===parseInt(orgNr[8],10)?!1:(orgNrErrorMsg='<div class="NAVerrorBox"><p>Organisasjonsnummer er ugyldig</p></div>',$(".orgnrError").html(orgNrErrorMsg).show(),!0)}function validerValgtEnhet(){var enhetErrorMsg="";return""==$("#navEnhetValgt").text()&&(enhetErrorMsg="<p>Du har ikke valgt NAV-kontor. Velg fra forslagslisten som dukker opp når du taster</p>"),""!=enhetErrorMsg?(enhetErrorMsg='<a name="scrollTop">&nbsp;</a><div class="NAVerrorBox">'+enhetErrorMsg+"</div>",$(".enhetError").html(enhetErrorMsg),$(".enhetError").show(),document.location.hash="#scrollTop",!0):($(".enhetError").html(""),$(".enhetError").hide(),!1)}function isTextAreaEmpty(textAreaContent){return""==textAreaContent||textAreaContent==beskrivelseInitText}function onBlur(el){""==el.value&&(el.value=el.defaultValue,$(el).addClass("defaultText"))}function onFocus(el){el.value==el.defaultValue&&(el.value="",$(el).removeClass("defaultText"))}function endreValgtEnhet(){$("#velgNavEnhetChangeButton").hide(),$("#navEnhetValgt").text(""),$("#navEnhetValgt").hide(),$("#Enhet").val(""),$("#Enhet").show(),"Ros"==$("input[name='subject']").val()&&$("input[name='to']").val(defaultEpostadresse)}function imposeMaxLength(Event,object,maxLen){object.value.length>maxLen&&(object.value=object.value.substring(0,maxLen));var gjenstaar=maxLen-object.value.length;return $("span#gjenstaar").text(gjenstaar),object.value.length<=maxLen||8==Event.keyCode||46==Event.keyCode||Event.keyCode>=35&&Event.keyCode<=40}function textareaInit(){$("#beskrivelse").val()===beskrivelseInitText?$("#beskrivelse").addClass("defaultText"):$("#beskrivelse").removeClass("defaultText")}function nullstill(){isTilbakemelding()||nullstillValgtEnhet(),nullstillBeskrivelsesFelt(),clearErrorMessages()}function nullstillValgtEnhet(){$("#velgNavEnhetChangeButton").click()}function nullstillBeskrivelsesFelt(){$("span#gjenstaar").text("1000"),$("#beskrivelse").addClass("defaultText")}function populateSubjectFieldWithSelectedCategory(){$("input[name='subject']").val($("#selectCategory").val())}function isTilbakemelding(){return"Tilbakemelding"==$("input[name='subject']").val()||$("input[name='subject']").val()==$("#selectCategory").val()}function isKlagePaaService(){return"Serviceklage"==$("input[name='subject']").val()}function isRos(){return"Ros"==$("input[name='subject']").val()}$(function(){$("#klage-ris-ros-skjema").on("submit",function(){return validateInput()})}),$(function(){$("#typeofservice").change(function(){"other"===$(this).val()?$("#othertypeofservice").parent("div").show():$("#othertypeofservice").val("").parent("div").hide()})}),$(function(){{var inputAc=$("#Enhet"),inputAcError=$(".enhetError"),selectedDep=$("#navEnhetValgt");$("input[name='to']").val()}textareaInit(),selectedDep.text(""),inputAcError.hide(),$(".beskrivelseError").hide(),$(".pnrError").hide(),$(".epostError").hide(),"undefined"!=typeof updateSubjectField&&populateSubjectFieldWithSelectedCategory(),inputAc.autocomplete({source:function(request,response){request.term=request.term.replace(/æ/g,"%C3%A6"),request.term=request.term.replace(/ø/g,"%C3%B8"),request.term=request.term.replace(/å/g,"%C3%A5"),request.term=request.term.replace(/Æ/g,"%C3%86"),request.term=request.term.replace(/Ø/g,"%C3%98"),request.term=request.term.replace(/Å/g,"%C3%85"),$.get(autocompleteUrl+"?term="+request.term,function(data){data&&response(JSON.parse(data))})},minLength:2,delay:400,select:function(event,ui){inputAc.val(ui.item.value),selectedDep.text(ui.item.label).show(),$("#velgNavEnhetChangeButton").show(),inputAc.hide(),inputAcError.html("")},focus:function(event,ui){event.preventDefault(),inputAc.val(ui.item.label)}})});