function Trim(e){return LTrim(RTrim(e))}function LTrim(e){var t=/^\s*/;return e.replace(t,"")}function RTrim(e){var t=/\s*$/;return e.replace(t,"")}function validateFnr(e){var t=[0,0,0,0,0,0,0,0,0,0,0],n=0,o=0,r=[3,7,6,1,8,9,4,5,2],a=[5,4,3,2,7,6,5,4,3,2],s=11,l=11,c=11;if("undefined"==e||e.length!=s||"00000000000"==e)return!1;for(i=0;s>i;i++){var u=e.charAt(i);if("0">u||u>"9")return!1;t[i]=u}for(i=0;s-2>i;i++)n+=t[i]*r[i];if(o=n%c,0==o&&(o=l),n=parseInt(t[s-2])+o-l,0!=n)return!1;for(n=0,i=0;s-1>i;i++)n+=t[i]*a[i];return o=n%c,(0==o||1==o)&&(o=l),n=parseInt(t[s-1])+o-l,0==n&&(validfnr=!0),0==n}function validateInput(e){clearErrorMessages();var t=!1;return t=validerBeskrivelsesFelt(),isTilbakemelding()?t|=validerEpostFelt():isKlagePaaService()?t=t|validerPersonnummerFelt()|validerOrgnr(e)|validerRequired():isRos()&&(t|=validerValgtEnhet()),t?!1:!0}function validerRequired(){$("form input.required").each(function(){var e=$(this),t=$.trim($(e).val());return t.length>0?(e.siblings(".formgroup-error").hide(),!1):(e.siblings(".formgroup-error").show(),!0)})}function clearErrorMessages(){$(".orgnrError").hide(),$(".formgroup-error").hide(),$(".enhetError").hide(),$(".pnrError").hide(),$(".epostError").hide(),$(".beskrivelseError").hide()}function validerBeskrivelsesFelt(){var e="";return isTextAreaEmpty($.trim($("#beskrivelse").val()))&&(e="<p>Tilbakemeldingsfeltet er ikke fylt ut</p>"),""!=e?(e='<a name="scrollTop">&nbsp;</a><div class="NAVerrorBox">'+e+"</div>",$(".beskrivelseError").html(e),$(".beskrivelseError").show(),!0):!1}function validerEpostFelt(){if($("#tbEmail").length){var e="";return epost=$("#tbEmail").val(),""!=epost&&(AtPos=epost.indexOf("@"),StopPos=epost.lastIndexOf("."),(-1==AtPos||-1==StopPos)&&(e="<p>E-postadressen er ikke gyldig </p>")),""!=e?(e='<a name="scrollTop">&nbsp;</a><div class="NAVerrorBox">'+e+"</div>",$(".epostError").html(e),$(".epostError").show(),!0):!1}}function validerPersonnummerFelt(){if($("#klagerPersonnummer").length){var e="",t=$("#klagerPersonnummer").val();return 11!=t.length||isNaN(t)?e="<p>Fødselsnummer skal bestå av 11 siffer</p>":validateFnr(t)||(e="<p>Fødselsnummer er ikke gyldig</p>"),""!=e?(e='<div class="NAVerrorBox">'+e+"</div>",$(".pnrError").html(e),$(".pnrError").show(),!0):($(".pnrError").html(""),$(".pnrError").hide(),!1)}}function validerOrgnr(e){if($("#orgnr").length){var t=/^[0-9]{9}$/,n=$("#orgnr").val(),i='<div class="NAVerrorBox"><p>Organisasjonsnummer skal bestå av ni siffer</p></div>';if(!n.match(t))return $(".orgnrError").html(i).show(),e.preventDefault(),!1;if(!n.match(t))return e.preventDefault(),!1;orgMod11(n,e)}}function orgMod11(e,t){for(var n=[3,2,7,6,5,4,3,2],i=0,o=0,r=0,a=0;8>a;a++)i+=e[a]*n[a];return o=i%11,r=0===o?0:11-o,1!==o&&r===parseInt(e[8],10)?!0:(orgNrErrorMsg='<div class="NAVerrorBox"><p>Organisasjonsnummer er ugyldig</p></div>',$(".orgnrError").html(orgNrErrorMsg).show(),t.preventDefault(),!1)}function validerValgtEnhet(){var e="";return""==$("#navEnhetValgt").text()&&(e="<p>Du har ikke valgt NAV-kontor. Velg fra forslagslisten som dukker opp når du taster</p>"),""!=e?(e='<a name="scrollTop">&nbsp;</a><div class="NAVerrorBox">'+e+"</div>",$(".enhetError").html(e),$(".enhetError").show(),document.location.hash="#scrollTop",!0):($(".enhetError").html(""),$(".enhetError").hide(),!1)}function isTextAreaEmpty(e){return""==e||e==beskrivelseInitText}function onBlur(e){""==e.value&&(e.value=e.defaultValue,$(e).addClass("defaultText"))}function onFocus(e){e.value==e.defaultValue&&(e.value="",$(e).removeClass("defaultText"))}function endreValgtEnhet(){$("#velgNavEnhetChangeButton").hide(),$("#navEnhetValgt").text(""),$("#navEnhetValgt").hide(),$("#velgNavEnhet").val(""),$("#velgNavEnhet").show(),"Ros"==$("input[name='subject']").val()&&$("input[name='to']").val(defaultEpostadresse)}function imposeMaxLength(e,t,n){t.value.length>n&&(t.value=t.value.substring(0,n));var i=n-t.value.length;return $("span#gjenstaar").text(i),t.value.length<=n||8==e.keyCode||46==e.keyCode||e.keyCode>=35&&e.keyCode<=40}function textareaInit(){$("#beskrivelse").val()===beskrivelseInitText?$("#beskrivelse").addClass("defaultText"):$("#beskrivelse").removeClass("defaultText")}function nullstill(){isTilbakemelding()||nullstillValgtEnhet(),nullstillBeskrivelsesFelt(),clearErrorMessages()}function nullstillValgtEnhet(){$("#velgNavEnhetChangeButton").click()}function nullstillBeskrivelsesFelt(){$("span#gjenstaar").text("1000"),$("#beskrivelse").addClass("defaultText")}function populateSubjectFieldWithSelectedCategory(){$("input[name='subject']").val($("#selectCategory").val())}function isTilbakemelding(){return"Tilbakemelding"==$("input[name='subject']").val()||$("input[name='subject']").val()==$("#selectCategory").val()}function isKlagePaaService(){return"Serviceklage"==$("input[name='subject']").val()}function isRos(){return"Ros"==$("input[name='subject']").val()}$(function(){$("#klage-ris-ros-skjema").on("submit",function(e){var t=validateInput(e);return t?($("#velgNavEnhet").val(""),!0):!1})}),$(function(){$("#typeofservice").change(function(){"other"===$(this).val()?$("#othertypeofservice").parent("div").show():$("#othertypeofservice").val("").parent("div").hide()})}),$(function(){var e=$("#Enhet"),t=$(".enhetError"),n=$("#navEnhetValgt");$("input[name='to']").val(),textareaInit(),n.text(""),t.hide(),$(".beskrivelseError").hide(),$(".pnrError").hide(),$(".epostError").hide(),"undefined"!=typeof updateSubjectField&&populateSubjectFieldWithSelectedCategory(),e.autocomplete({source:function(e,t){e.term=e.term.replace(/æ/g,"%C3%A6"),e.term=e.term.replace(/ø/g,"%C3%B8"),e.term=e.term.replace(/å/g,"%C3%A5"),e.term=e.term.replace(/Æ/g,"%C3%86"),e.term=e.term.replace(/Ø/g,"%C3%98"),e.term=e.term.replace(/Å/g,"%C3%85"),$.get(autocompleteUrl+"?term="+e.term,function(e){e&&t(JSON.parse(e))})},minLength:2,delay:400,select:function(i,o){e.val(o.item.value),n.text(o.item.label).show(),$("#velgNavEnhetChangeButton").show(),e.hide(),t.html("")},focus:function(t,n){t.preventDefault(),e.val(n.item.label)}})});